<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .sim-input { margin-bottom: 5px; }
        .card { box-shadow: 0 2px 4px rgba(0,0,0,0.05); border: none; }
    </style>
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-dark mb-4">
    <div class="container">
        <span class="navbar-brand">City Compare | Welcome, {{ user.username }}</span>
        <div>
            <span class="text-light me-3">Contributions: <strong>{{ count }}</strong></span>
            {% if count >= 10 or user.is_admin_approved %}
                <a href="{{ url_for('list_view') }}" class="btn btn-success btn-sm me-2">Global List (Unlocked)</a>
            {% else %}
                <button class="btn btn-secondary btn-sm me-2" disabled>Global List ({{ 10 - count }} more to unlock)</button>
            {% endif %}
            <a href="{{ url_for('logout') }}" class="btn btn-outline-light btn-sm">Logout</a>
        </div>
    </div>
</nav>

<div class="container">
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div class="alert alert-info">{{ messages[0] }}</div>
        {% endif %}
    {% endwith %}

    <div class="card p-4 mb-5">
        <h4>New Comparison</h4>
        <form method="POST">
            <input type="hidden" name="action" value="add">
            <div class="row mb-3">
                <div class="col-md-6">
                    <label>US City</label>
                    <select name="us_city" class="form-select" required>
                        {% for city in us_cities %}
                            <option value="{{ city.id }}">{{ city.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-6">
                    <label>Turkish City</label>
                    <select name="tr_city" class="form-select" required>
                        {% for city in tr_cities %}
                            <option value="{{ city.id }}">{{ city.name }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            
            <label>5 Similarities (Max 20 chars each):</label>
            <div class="row">
                {% for i in range(1, 6) %}
                <div class="col-md-2">
                    <input type="text" name="sim{{ i }}" class="form-control sim-input" placeholder="Sim {{ i }}" maxlength="20" required>
                </div>
                {% endfor %}
                <div class="col-md-2">
                    <button type="submit" class="btn btn-primary w-100">Add</button>
                </div>
            </div>
        </form>
    </div>

    <h4>Your Comparisons</h4>
    <div class="row">
        {% for comp in comparisons %}
        <div class="col-12 mb-3">
            <div class="card p-3">
                <form method="POST" class="row align-items-center">
                    <input type="hidden" name="action" value="edit">
                    <input type="hidden" name="comp_id" value="{{ comp.id }}">
                    
                    <div class="col-md-3">
                        <strong>{{ comp.city_us.name }}</strong> (USA) <br> vs <br> <strong>{{ comp.city_tr.name }}</strong> (TR)
                    </div>
                    
                    <div class="col-md-7">
                        <div class="input-group input-group-sm mb-1">
                            <input type="text" name="sim1" value="{{ comp.sim1 }}" class="form-control" maxlength="20">
                            <input type="text" name="sim2" value="{{ comp.sim2 }}" class="form-control" maxlength="20">
                            <input type="text" name="sim3" value="{{ comp.sim3 }}" class="form-control" maxlength="20">
                            <input type="text" name="sim4" value="{{ comp.sim4 }}" class="form-control" maxlength="20">
                            <input type="text" name="sim5" value="{{ comp.sim5 }}" class="form-control" maxlength="20">
                        </div>
                    </div>

                    <div class="col-md-2 text-end">
                        <button type="submit" class="btn btn-warning btn-sm">Save</button>
                        <button type="submit" name="action" value="delete" class="btn btn-danger btn-sm" onclick="return confirm('Delete?');">Delete</button>
                    </div>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
</body>
</html>